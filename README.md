# Optical Remote Sensing Detection
–î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–∞—Ö üåçüõ∞

–≠—Ç–æ—Ç –∫–µ–π—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–∏—Å—Ç–µ–º—É –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–∞—Ö. –°–∏—Å—Ç–µ–º–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ YOLOv3 –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∑–¥–∞–Ω–∏—è, –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –∏ –¥—Ä—É–≥–∏–µ –Ω–∞ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–∞—Ö –ó–µ–º–ª–∏.

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏](https://github.com/Vlad15lav/ors-detection#–ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞-–∑–∞–¥–∞—á–∏)
2. [Requirements](https://github.com/Vlad15lav/ors-detection#requirements)
3. [–ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö DIOR](https://github.com/Vlad15lav/ors-detection#–Ω–∞–±–æ—Ä-–¥–∞–Ω–Ω—ã—Ö-dior)
4. [–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏](https://github.com/Vlad15lav/ors-detection#–æ–±—É—á–µ–Ω–∏–µ-–º–æ–¥–µ–ª–∏)
5. [–û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏](https://github.com/Vlad15lav/ors-detection#–æ—Ü–µ–Ω–∫–∞-–º–æ–¥–µ–ª–∏)
6. [–î–µ–º–æ Inference](https://github.com/Vlad15lav/ors-detection#–¥–µ–º–æ-inference)
7. [–¢–µ–ª–µ–≥—Ä–∞–º–º –±–æ—Ç](https://github.com/Vlad15lav/ors-detection#—Ç–µ–ª–µ–≥—Ä–∞–º–º-–±–æ—Ç)
8. [Web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ](https://github.com/Vlad15lav/ors-detection#web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
9. [–°—Å—ã–ª–∫–∏](https://github.com/Vlad15lav/ors-detection#—Å—Å—ã–ª–∫–∏)

## –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏
–¶–µ–ª—å—é –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ - —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –æ–ø—Ç–∏—á–µ—Å–∫–∏—Ö —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–∞—Ö. –ù–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞–µ—Ç—Å—è —Å–ø—É—Ç–Ω–∏–∫–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã—è–≤–∏—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ—Å—è –æ–±—ä–µ–∫—Ç—ã.

## Requirements
–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:
```
pip install -U -r requirements.txt
```

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –¥–∞–Ω–Ω—ã–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–¥–∞—á–∏ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤  - [–ù–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤](https://github.com/Vlad15lav/ObjectDetection-Toolkit)

## –ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö DIOR
–î–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö Detection in Optical Remote.  
DIOR –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫—Ä—É–ø–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω—ã–π –∏ –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–π –Ω–∞–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –æ–ø—Ç–∏—á–µ—Å–∫–∏—Ö —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–∞—Ö. –í –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è 23463 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å 192472 –æ–±—ä–µ–∫—Ç–∞–º–∏, –æ—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–º–∏ 20 –∫–ª–∞—Å—Å–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤. DIOR –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –±–æ–ª—å—à–∏–º —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ–º —Ä–∞–∑–º–µ—Ä–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤, —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏ —Å—ä–µ–º–∫–∏ (–ø–æ–≥–æ–¥–∞, —Å–µ–∑–æ–Ω—ã) –∏ –∫–∞—á–µ—Å—Ç–≤–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –≠—Ç–æ—Ç –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –º–µ—Ç–æ–¥—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤, –∞ —Ç–∞–∫–∂–µ —Å–ª—É–∂–∏—Ç –±–∞–∑–æ–π –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –≤ —ç—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏.

–ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –Ω–∞ [Google Disk](https://drive.google.com/file/d/16JeLkqdOA1oF0WtyYdKnJhq3i9eEcX4_/view?usp=sharing)

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:
![–ü—Ä–∏–º–µ—Ä –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö](/images/diorset.png)


## –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
–î–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:
```bash
python train.py --path data/DIOR-full --cfg dior --img_size 512 --lr 0.005 --epoches 50 --batch_size 12 --debug
```
–î–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:
```bash
python train.py --path data/DIOR-full --cfg dior --img_size 512 --load_train --epoches 50 --batch_size 12 --debug
```

### –ì—Ä–∞—Ñ–∏–∫ –æ–±—É—á–µ–Ω–∏—è:  
![–ì—Ä–∞—Ñ–∏–∫ –æ–±—É—á–µ–Ω–∏—è](/images/YOLOv3-training.jpg)

## –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏
–î–ª—è –æ—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:
```bash
python eval.py --path data/DIOR-full --cfg dior --img_size 512 --batch_size 12
```

**–°—Ä–µ–¥–Ω–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —Ç–æ—á–Ω–æ—Å—Ç–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è (mAP):** 73.1%

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –±—ã–ª —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —Ç–æ—á–Ω–æ—Å—Ç–∏ (AP):

| –ö–ª–∞—Å—Å                     | AP     |
|---------------------------|--------|
| airplane                  | 81.6   |
| airport                   | 76.1   |
| baseballfield             | 84.6   |
| basketballcourt           | 88.6   |
| bridge                    | 48.9   |
| chimney                   | 75.9   |
| dam                       | 61.1   |
| Expressway-Service-area   | 82.9   |
| Expressway-toll-station   | 78.0   |
| golffield                 | 69.1   |
| groundtrackfield          | 86.5   |
| harbor                    | 56.3   |
| overpass                  | 90.4   |
| ship                      | 51.9   |
| stadium                   | 78.4   |
| storagetank               | 88.9   |
| tenniscourt               | 61.1   |
| trainstation              | 56.0   |
| vehicle                   | 89.2   |
| windmill                  | 57.8   |

### –ü—Ä–∏–º–µ—Ä—ã –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:  
<img src="/images/test.gif" alt="drawing" width="500"/>

–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–µ—Å–æ–≤ YOLOv3 –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:

```bash
wget https://github.com/Vlad15lav/ors-detection/releases/download/weights/dior_weights.pth -O states/dior_weights.pth
```

## –î–µ–º–æ Inference
–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç:
```bash
python inference.py -p images/test_sample.jpg --cfg dior --img_size 512
```
–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è.

### –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫—Ä–∏–ø—Ç–∞:
![–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫—Ä–∏–ø—Ç–∞](/images/test_sample_result.png)

## –¢–µ–ª–µ–≥—Ä–∞–º–º –±–æ—Ç
–ó–∞–≥—Ä—É–∑–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö MySQL –¥–ª—è —Ç–µ–ª–µ–≥—Ä–∞–º–º –±–æ—Ç–∞:
```bash
mysql -u root -p detector_bot < db/detector_bot.sql
```
–í —Å–∫—Ä–∏–ø—Ç–µ bot.py —É–∫–∞–∂–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è MySQL —Å–µ—Ä–≤–µ—Ä–∞ –∏ Token Bot Father:
```python
# –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –ë–î –∏ —Ç–æ–∫–µ–Ω –¢–µ–ª–µ–≥—Ä–∞–º–º–∞
DATABASE_ADDRESS = "YOUR ADDRESS"
DATABASE_USER = "YOUR USER"
DATABASE_PASW = "YOUR PASSWORD"
DATABASE_NAME = "YOUR DATABASE NAME"
BOT_TOKEN = "YOUR TOKEN"
```
–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã:
```bash
python bot.py
```

## Web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
–ù–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ Streamlit –∏ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –æ–ø—Ç–∏—á–µ—Å–∫–∏—Ö —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö —Å–Ω–∏–º–∫–∞—Ö. –ü—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ [—Å—é–¥–∞](https://space-detector.streamlit.app/) –∏ –Ω–∞—á–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

–° –ø–æ–º–æ—â—å—é Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–µ —Å–Ω–∏–º–∫–∏, –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ —Å–Ω–∏–º–∫–∞—Ö –∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤–≤–µ—Å—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ª—é–±–æ–π —Ç–æ—á–∫–∏ –ó–µ–º–ª–∏, —á—Ç–æ–±—ã —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∏—Ç—å —Å–Ω–∏–º–æ–∫.

![Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ](/images/stremlit-preview.png)

## –°—Å—ã–ª–∫–∏
- [Detection in Optical Remote Sensing Dataset](https://arxiv.org/ftp/arxiv/papers/1909/1909.00133.pdf)
- [You Only Look Once V3](https://arxiv.org/pdf/1804.02767.pdf)
